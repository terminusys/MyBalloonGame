# 管理员面板功能测试指南

## 📋 测试前准备

1. 确保浏览器已清除缓存（或使用无痕模式）
2. 打开开发者工具（F12）查看 Console
3. 准备测试用的图片文件（收款码、广告图片）

---

## ✅ 测试步骤

### 测试1: 管理员登录

1. **打开游戏页面**
   - 输入玩家名称，点击"开始飞行"
   
2. **点击"⚙️ 管理员设置"按钮**
   - 位置：左上角
   
3. **输入错误的账号密码**
   - 账号：`test`
   - 密码：`123456`
   - ✅ 预期：弹出"账号或密码错误！"
   
4. **输入正确的账号密码**
   - 账号：`DDKJ`
   - 密码：`DDKJ88888888`
   - ✅ 预期：打开管理员设置面板

---

### 测试2: 标签页切换

1. **默认显示"🎮 游戏参数"标签**
   - ✅ 预期：标签高亮，显示游戏参数设置

2. **点击"💳 支付设置"标签**
   - ✅ 预期：标签切换，显示支付设置内容

3. **点击"🎯 广告管理"标签**
   - ✅ 预期：标签切换，显示广告管理内容

4. **再次点击"🎮 游戏参数"标签**
   - ✅ 预期：返回游戏参数设置

---

### 测试3: 游戏参数设置

#### 3.1 修改金币参数

1. **修改金币生成概率**
   - 原值：`0.02`
   - 改为：`0.05`（快速生成测试）
   
2. **修改金币最大数量**
   - 原值：`20`
   - 改为：`30`
   
3. **点击"保存参数"**
   - ✅ 预期：弹出"✅ 游戏参数已保存！"
   
4. **游戏中观察**
   - ✅ 预期：金币生成速度明显变快
   - ✅ 预期：屏幕上金币数量可以达到30个

#### 3.2 修改钻石参数

1. **修改钻石生成间隔**
   - 原值：`100000`（100秒）
   - 改为：`10000`（10秒，方便测试）
   
2. **修改每次生成数量**
   - 原值：`5`
   - 改为：`3`
   
3. **保存并观察**
   - ✅ 预期：每10秒生成3个钻石道具

#### 3.3 恢复默认参数

1. **点击"恢复默认"按钮**
   - ✅ 预期：弹出确认对话框
   
2. **点击"确定"**
   - ✅ 预期：所有参数恢复默认值
   - ✅ 预期：表单显示默认值

---

### 测试4: 支付设置

#### 4.1 支付宝收款码

1. **点击"上传收款码图片"**
   - 选择一张二维码图片
   
2. **检查预览**
   - ✅ 预期：图片显示在下方
   
3. **点击"保存支付设置"**
   - ✅ 预期：弹出"✅ 支付设置已保存！"
   
4. **测试充值流程**
   - 关闭管理员面板
   - 点击"充值"按钮
   - 选择"支付宝"支付方式
   - 点击"确认充值"
   - ✅ 预期：弹出支付宝收款码（显示刚才上传的图片）

#### 4.2 微信收款码

1. **上传微信收款码图片**
   - 重复上述步骤
   
2. **测试充值流程**
   - ✅ 预期：微信支付时显示微信收款码

#### 4.3 Visa/Mastercard 设置

1. **输入 Visa 账户信息**
   - 账户名：`ZHANG SAN`
   - 卡号：`**** **** **** 1234`
   
2. **保存设置**
   
3. **测试充值流程**
   - 选择 Visa 支付
   - ✅ 预期：显示输入卡号的表单

---

### 测试5: 广告管理

#### 5.1 添加纯文字广告气球

1. **输入广告词**
   - `欢迎来到气球世界！`
   
2. **设置位置**
   - X: `400`
   - Y: `300`
   
3. **设置透明度**
   - `0.8`
   
4. **点击"添加广告气球"**
   - ✅ 预期：广告气球添加到列表
   - ✅ 预期：游戏中看到广告文字

#### 5.2 添加图片广告气球

1. **输入广告词**
   - `精美图片广告`
   
2. **上传广告图片**
   - 选择一张宽高比为 4:3 的图片
   
3. **设置位置**
   - X: `600`
   - Y: `200`
   
4. **设置透明度**
   - `0.6`（半透明）
   
5. **添加并检查**
   - ✅ 预期：游戏中看到半透明的广告图片
   - ✅ 预期：图片保持原始比例，没有变形

#### 5.3 验证层级正确性

1. **操控玩家气球飞过广告**
   - ✅ 预期：玩家气球在广告之上
   - ✅ 预期：玩家不会被广告遮挡
   
2. **观察金币生成位置**
   - ✅ 预期：金币在广告之上
   - ✅ 预期：即使金币和广告重叠，金币也清晰可见
   
3. **观察障碍物**
   - ✅ 预期：障碍物（雷云、小鸟）在广告之上

#### 5.4 删除广告气球

1. **在"现有广告气球"列表中找到要删除的广告**
   
2. **点击"删除"按钮**
   - ✅ 预期：弹出确认对话框
   
3. **确认删除**
   - ✅ 预期：广告从列表中消失
   - ✅ 预期：游戏中该广告也消失

---

## 🔍 数据持久化测试

### 测试6: 刷新页面后设置是否保留

1. **完成所有设置**
   - 游戏参数修改
   - 支付方式设置
   - 添加广告气球
   
2. **刷新浏览器页面（F5）**
   
3. **重新登录管理员面板**
   - ✅ 预期：游戏参数保持之前的设置
   - ✅ 预期：支付收款码仍然存在
   - ✅ 预期：广告气球仍然显示
   
4. **打开开发者工具 > Application > Local Storage**
   - ✅ 预期：看到以下键值：
     - `gameSettings`
     - `paymentSettings`
     - `adBalloons`

---

## 🎮 游戏功能集成测试

### 测试7: 完整游戏流程

1. **设置快速测试参数**
   ```
   金币生成概率: 0.05
   金币最大数量: 30
   钻石生成间隔: 20000 (20秒)
   障碍物生成概率: 0.02
   ```
   
2. **添加1-2个广告气球**
   
3. **开始游戏**
   - 移动气球
   - 收集金币
   - ✅ 预期：金币快速生成
   
4. **等待20秒**
   - ✅ 预期：出现钻石道具
   - ✅ 预期：收集钻石增加10点积分
   
5. **碰撞障碍物**
   - ✅ 预期：生命值减少
   
6. **收集加血包**
   - ✅ 预期：生命值增加20
   
7. **兑换钻石**
   - 收集100个金币
   - 点击钻石显示区域
   - ✅ 预期：100金币兑换1钻石

---

## 🐛 常见问题排查

### 问题1: 管理员面板打不开
- **检查**: Console 是否有报错
- **解决**: 清除浏览器缓存，刷新页面

### 问题2: 设置保存后没生效
- **检查**: Local Storage 是否被禁用
- **解决**: 检查浏览器隐私设置

### 问题3: 上传的图片不显示
- **检查**: 图片格式是否支持（JPG, PNG, GIF）
- **检查**: 图片大小是否过大（建议 < 1MB）
- **解决**: 压缩图片后重新上传

### 问题4: 广告气球位置不对
- **原因**: Phaser 坐标系统
- **解决**: X: 0-800, Y: 0-600 范围内调整

### 问题5: 多个玩家看不到彼此
- **检查**: Supabase 配置是否正确
- **检查**: 网络连接是否正常
- **解决**: 查看 Console 是否有 Supabase 连接错误

---

## 📊 性能测试建议

1. **测试极限参数**
   - 金币生成概率: `0.1`（极快）
   - 金币最大数量: `50`（极多）
   - 观察游戏是否卡顿

2. **测试大量广告**
   - 添加 5-10 个广告气球
   - 观察渲染性能

3. **测试大图片**
   - 上传 1920x1080 的广告图片
   - 观察加载速度

---

## ✅ 测试检查清单

- [ ] 管理员登录成功
- [ ] 三个标签页都能正常切换
- [ ] 游戏参数可以修改并保存
- [ ] 恢复默认参数功能正常
- [ ] 支付宝收款码可以上传并显示
- [ ] 微信收款码可以上传并显示
- [ ] Visa/Mastercard 信息可以保存
- [ ] 可以添加纯文字广告气球
- [ ] 可以添加带图片的广告气球
- [ ] 广告图片保持原始比例
- [ ] 广告透明度设置生效
- [ ] 可以删除广告气球
- [ ] 玩家气球始终在广告之上
- [ ] 金币/障碍物在广告之上
- [ ] 刷新页面后设置仍然保留
- [ ] 游戏参数修改后立即生效
- [ ] 充值时显示正确的收款码
- [ ] 钻石兑换功能正常
- [ ] 生命值系统正常
- [ ] 多人同步正常

---

## 📞 技术支持

如有任何问题，请检查：
1. 浏览器 Console 的错误信息
2. Local Storage 的数据内容
3. Supabase 连接状态

测试完成后，请将发现的问题记录下来！
